# mim-serialization-api-4-java
[![standard-readme compliant](https://img.shields.io/badge/readme%20style-standard-brightgreen.svg?style=flat-square)](https://github.com/RichardLitt/standard-readme)

The MIM serialization API for Java is a library for JVM based languages (Java, Kotlin, Scala, Groovy, Clojure etc.) for reading and writing MIM (Metamodel voor Informatiemodellering) XML serializations following MIM version 1.1.0, 1.1.1 and 1.2. The library makes use of the [JAXB](https://en.wikipedia.org/wiki/Jakarta_XML_Binding) framework to map Java classes to XML and vice versa based on the MIM XML Schemas. A number of the generated classes is extended to provide important extra functionality.

## Table of Contents

- [Overview](#overview)
- [Loading (or "unmarshalling", "deserializing") an existing MIM serialization](#loading-or-unmarshalling-deserializing-an-existing-mim-serialization)

## Loading an existing MIM serialization

An existing MIM serialization (like the ones that are generated by [Imvertor](https://github.com/Imvertor/Imvertor-Maven)) can be loaded (or "unmarshalled", "deserialized") using the `MimSerializationApi` class:

```java
MimModel mimModel = MimSerializationApi.loadModel(inputStream)
```

Now mimModel is of one of the classes:

* `nl.geostandaarden.mim_1_2.relatiesoort.MimModel`
* `nl.geostandaarden.mim_1_2.relatierol.MimModel`
* `nl.geostandaarden.mim_1_1_1.relatiesoort.MimModel`
* `nl.geostandaarden.mim_1_1_1.relatierol.MimModel`
* `nl.geostandaarden.mim_1_1_0.relatiesoort.MimModel`
* `nl.geostandaarden.mim_1_1_0.relatierol.MimModel`

depending in the MIM `versie` and the `relatiemodelleringstype` that the API detected in the MIM serialization. 

The API can also validate the MIM serialization against the MIM XML schema during load:  

```java
MimModel mimModel = MimSerializationApi.loadModel(mimSerialization, new ValidationEventHandler() {
  @Override
  public boolean handleEvent(ValidationEvent event) {
    System.out.println("Validation error: " + event.getMessage() + " (" + event.getSeverity() + ")");
    return event.getSeverity() == ValidationEvent.WARNING;
  }
});
```

Traversal of the MIM model starts with the Informatiemodel:
```java
Informatiemodel informatiemodel = mimModel.getInformatiemodel();
```
For instance to get all Objecttypes of the first Domein:
```java
List<Objecttype> objectTypes = mimModel.getInformatiemodel().getPackages().getDomein().get(0).getObjecttypen().getObjecttype();
```

A number of the classes that were generated by JAXB are extended to provide some important extra functionality:

### Following links
TODO

### Getting and setting Xhtml content
TODO

See the sample application: [LoadMimModel.java](src/main/java/nl/geostandaarden/mim/samples/LoadMimModel.java)

## Creating a new MIM model
A new MIM model can be created using the method `MimSerializationApi.newModel`, for instance:

```java
MimModel mimModel = MimSerializationApi.newModel(MIM_VERSION.VERSION_1_2, MIM_RELATIEMODELLERINGSTYPE.RELATIESOORT_LEIDEND);
```

In this example the mimModel will be of the class `nl.geostandaarden.mim_1_2.relatiesoort.MimModel`. 

After the model is created the (required) properties of the Informationmodel object can be set and new model elements can be added, for instance:

```java
mimModel.setNaam("Mijn nieuwe model");
mimModel.setMIMTaal("NL");
// ... etc. ...

Informatiemodel.Packages packages = new Informatiemodel.Packages();
model.setPackages(packages);
Domein domeinContacts = new Domein();
packages.getDomein().add(domein);

domeinContacts.setNaam("Contacten")   
domeinContacts.setId("domein-contacten");
// ... etc. ...
```

TODO: add text about reference indexing

TODO: add text how to use the extended classes

## Saving a MIM model
A MIM model can be saved (or "marshalled", "serialized") using the `save` methods of MimModel:

```java
mimModel.save(outputStream)
```

The API can also validate the MIM serialization against the MIM XML schema during save:

```java
mimModel.save(outputStream, new ValidationEventHandler() {
  @Override
  public boolean handleEvent(ValidationEvent event) {
    System.out.println("Validation error: " + event.getMessage() + " (" + event.getSeverity() + ")");
    return event.getSeverity() == ValidationEvent.WARNING;
  }
});
```
See the sample application: [SaveMimModel.java](src/main/java/nl/geostandaarden/mim/samples/SaveMimModel.java)
